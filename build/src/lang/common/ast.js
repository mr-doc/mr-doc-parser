"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const text_1 = require("../../utils/text");
const range_1 = require("../../utils/range");
const xdoc_parser_1 = require("xdoc-parser");
const _ = require("lodash");
function isASTNode(object) {
    return object && 'type' in object && 'text' in object && 'children' in object;
}
exports.isASTNode = isASTNode;
function createASTNode(source, node, arg1, arg2) {
    let context, children = [], document = typeof arg2 === 'boolean' && arg2 === true, properties;
    if (_.isPlainObject(arg1) && !isASTNode(arg1)) {
        properties = arg1;
    }
    else if (_.isPlainObject(arg1) && isASTNode(arg1)) {
        context = arg1;
    }
    else if (_.isArray(arg1)) {
        children = arg1;
    }
    if (_.isPlainObject(arg2)) {
        properties = arg2;
    }
    return Object.assign({ type: node.type, text: text_1.text(source, node) }, range_1.default(node), { context,
        children, comment: document ? xdoc_parser_1.default(source.text).parse() : undefined, properties });
}
exports.createASTNode = createASTNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xhbmcvY29tbW9uL2FzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDJDQUF3QztBQUN4Qyw2Q0FBc0M7QUFFdEMsNkNBQStCO0FBQy9CLDRCQUEyQjtBQUczQixTQUFnQixTQUFTLENBQUMsTUFBYztJQUN0QyxPQUFPLE1BQU0sSUFBSSxNQUFNLElBQUksTUFBTSxJQUFJLE1BQU0sSUFBSSxNQUFNLElBQUksVUFBVSxJQUFJLE1BQU0sQ0FBQztBQUNoRixDQUFDO0FBRkQsOEJBRUM7QUFPRCxTQUFnQixhQUFhLENBQUMsTUFBYyxFQUFFLElBQWdCLEVBQUUsSUFBVSxFQUFFLElBQVU7SUFFcEYsSUFBSSxPQUFPLEVBQUUsUUFBUSxHQUFHLEVBQUUsRUFBRSxRQUFRLEdBQUcsT0FBTyxJQUFJLEtBQUssU0FBUyxJQUFJLElBQUksS0FBSyxJQUFJLEVBQUUsVUFBVSxDQUFDO0lBRTlGLElBQUksQ0FBQyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUM3QyxVQUFVLEdBQUcsSUFBSSxDQUFDO0tBQ25CO1NBQU0sSUFBSSxDQUFDLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNuRCxPQUFPLEdBQUcsSUFBSSxDQUFDO0tBQ2hCO1NBQU0sSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQzFCLFFBQVEsR0FBRyxJQUFJLENBQUM7S0FDakI7SUFFRCxJQUFJLENBQUMsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDekIsVUFBVSxHQUFHLElBQUksQ0FBQztLQUNuQjtJQUVELHVCQUNFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUNmLElBQUksRUFBRSxXQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUNyQixlQUFLLENBQUMsSUFBSSxDQUFDLElBQ2QsT0FBTztRQUNQLFFBQVEsRUFDUixPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxxQkFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUN6RCxVQUFVLElBQ1g7QUFDSCxDQUFDO0FBekJELHNDQXlCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN5bnRheE5vZGUgfSBmcm9tIFwidHJlZS1zaXR0ZXJcIjtcbmltcG9ydCB7IHRleHQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdGV4dFwiO1xuaW1wb3J0IHJhbmdlIGZyb20gXCIuLi8uLi91dGlscy9yYW5nZVwiO1xuaW1wb3J0IFNvdXJjZSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9Tb3VyY2VcIjtcbmltcG9ydCB4ZG9jIGZyb20gJ3hkb2MtcGFyc2VyJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IEFTVE5vZGUgZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvQVNUTm9kZVwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNBU1ROb2RlKG9iamVjdDogb2JqZWN0KTogb2JqZWN0IGlzIEFTVE5vZGUge1xuICByZXR1cm4gb2JqZWN0ICYmICd0eXBlJyBpbiBvYmplY3QgJiYgJ3RleHQnIGluIG9iamVjdCAmJiAnY2hpbGRyZW4nIGluIG9iamVjdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFTVE5vZGUoc291cmNlOiBTb3VyY2UsIG5vZGU6IFN5bnRheE5vZGUpOiBBU1ROb2RlXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQVNUTm9kZShzb3VyY2U6IFNvdXJjZSwgbm9kZTogU3ludGF4Tm9kZSwgcHJvcGVydGllczogb2JqZWN0KVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFTVE5vZGUoc291cmNlOiBTb3VyY2UsIG5vZGU6IFN5bnRheE5vZGUsIGNoaWxkcmVuOiBvYmplY3RbXSk6IEFTVE5vZGVcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBjaGlsZHJlbjogb2JqZWN0W10sIHByb3BlcnRpZXM6IG9iamVjdClcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBjb250ZXh0OiBBU1ROb2RlLCBkb2N1bWVudDogYm9vbGVhbik6IEFTVE5vZGVcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBU1ROb2RlKHNvdXJjZTogU291cmNlLCBub2RlOiBTeW50YXhOb2RlLCBhcmcxPzogYW55LCBhcmcyPzogYW55KTogQVNUTm9kZSB7XG5cbiAgbGV0IGNvbnRleHQsIGNoaWxkcmVuID0gW10sIGRvY3VtZW50ID0gdHlwZW9mIGFyZzIgPT09ICdib29sZWFuJyAmJiBhcmcyID09PSB0cnVlLCBwcm9wZXJ0aWVzO1xuXG4gIGlmIChfLmlzUGxhaW5PYmplY3QoYXJnMSkgJiYgIWlzQVNUTm9kZShhcmcxKSkge1xuICAgIHByb3BlcnRpZXMgPSBhcmcxO1xuICB9IGVsc2UgaWYgKF8uaXNQbGFpbk9iamVjdChhcmcxKSAmJiBpc0FTVE5vZGUoYXJnMSkpIHtcbiAgICBjb250ZXh0ID0gYXJnMTtcbiAgfSBlbHNlIGlmIChfLmlzQXJyYXkoYXJnMSkpIHtcbiAgICBjaGlsZHJlbiA9IGFyZzE7XG4gIH1cblxuICBpZiAoXy5pc1BsYWluT2JqZWN0KGFyZzIpKSB7XG4gICAgcHJvcGVydGllcyA9IGFyZzI7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6IG5vZGUudHlwZSxcbiAgICB0ZXh0OiB0ZXh0KHNvdXJjZSwgbm9kZSksXG4gICAgLi4ucmFuZ2Uobm9kZSksXG4gICAgY29udGV4dCxcbiAgICBjaGlsZHJlbixcbiAgICBjb21tZW50OiBkb2N1bWVudCA/IHhkb2Moc291cmNlLnRleHQpLnBhcnNlKCkgOiB1bmRlZmluZWQsXG4gICAgcHJvcGVydGllcyxcbiAgfVxufVxuIl19